<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>

    <link rel="stylesheet" href="style/style.css">
</head>
<body class='vertikal-flex'>
    
        <h1>Login</h1>
        <p id='result'></p>

<!-- START USER HINZUFÜGEN -->
       <form id="form" method="post">
            <input type="text", id="form_post_name" placeholder="Benutzername"/>
            <input type="submit" value="Add"/>
       </form>

         <div>
            <h3>The Following data is successfuly posted</h3>
            <h4 id="post_name"></h4>
            <h5 id="post_id"></h5>
         </div>
         <p>&nbsp;</p>

<!-- END USER HINZUFÜGEN -->

<!-- START USER HERAUSLESEN -->
<form id="get_form" method="get">
   <!-- <input type="text", id="form_name" placeholder="Name"/></br>-->
    <input type="text", id="form_get_id" placeholder="Id"/>
    <input type="submit" value="Search"/>
 </form>

 <div>
    <h3>The Following data were successfuly found</h3>
    <h4 id="get_name"></h4>
    <h5 id="get_id"></h5>
</div>

<!-- END USER HERAUSLESEN -->

    

<script>
// START USER HINZUFÜGEN

const userDetails = JSON.parse(localStorage.getItem("userDetails")) || [];
var form = document.getElementById('form')

    form.addEventListener('submit', function(e) {
        e.preventDefault()

        /*verstehe nicht wieso, aber ich muss beide Zeilen hier lassen, sonst gab es einen Fehler */
        /*sollte bereinigt werden */
        /*ABER: bitte nachfolgende 6 Zeilen Code NICHT einfach so löschen... */
        var name = document.getElementById('form_post_name').value
        var id = Date.now()

        const userDetails = {
            name: name = document.getElementById('form_post_name').value,
            id: id = Date.now()
        };

        console.log(userDetails); 
    
        localStorage.setItem('userDetails', JSON.stringify(userDetails));  /* userDetails in Local Storage */
    
        // ID options:
            //Math.random().toString(16).slice(2) 
            //Date.now() 
            //document.getElementById('form_id').value

        //API Fetch POST
        fetch('https://343505-26.web.fhgr.ch/api/jump-and-run/spieler/', {
            method: 'POST', 
            body: JSON.stringify({
                name:name,
                id:id,
        }),
        // Adding headers to the request
        headers: {
            "Content-type": "application/json; charset=UTF-8"
    }
    })

    .then(function(response){ 
        return response.json()})
    .then(function(data)
        {console.log(data)
        name=document.getElementById("post_name")
        id=document.getElementById("post_id")
        name.innerHTML = data.name
        id.innerHTML = data.id
        }).catch(error => console.error('Error:', error)); 
    });

// END USER HINZUFÜGEN
</script>

<a href="spiel.html">Zum Spiel</a>

<a href="highscore.html">Zum Highscore</a>
<br>
<br>
<br>
<br>
<a href="index.html">Zurück</a>
<!--Design für Formatierung Button inkl Schrif ist in CSS unter a:link (...) zu finden.-->
<!--Alle Buttons auf allen html haben dieselbe Formatierung.-->
</body>
</html>